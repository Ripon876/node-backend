<%- include("../../partials/admin-header") -%>
<%- include("../../partials/admin-nav") -%>


        <div class="content-wrapper p-5">
         
          <div class="row">
            <div class="col-md-12 stretch-card">
              <div class="card">
                <div class="card-body">
                <div class="align-items-baseline d-flex justify-content-between">
                        <p class="card-title">Interns</p>
                        <div>
                          <a href="/interns/new"   class="btn btn-primary">Add New</a>               
                        </div>

                  </div>

               <div class="table-responsive">
                              <table id="recent-purchases-listing" class="table">
                                <thead>
                                  <tr>
                                      <th>Image</th>
                                      <th>Name</th>
                                      <th>Position</th>
                                      <th>Actions</th>
                                  </tr>
                                </thead>
                                <tbody>


                    <% if(interns){ %>
                        <% interns.forEach((intern)=> {  %>
                          <tr>
                              <td><img src="<%= intern.img %>" alt=""></td>
                              <td><h4><%= intern.name %></h4></td> 
                              <td><h4><%= intern.position %></h4></td> 
                              <td class="text-center">
                                <input type="text" value="<%= JSON.stringify(intern) %>" class="d-none">
                                <button class="btn btn-danger px-3 py-2 deleteIntern">Delete</button>
                              </td>
                          </tr>   
                       <%  }) %>
                    <% } %> 

                         
                      </tbody>
                    </table>
                  </div>


                </div>
              </div>
            </div>
          </div>
        </div>




<script type="text/javascript">


function readURL(input) {

  if (input.files && input.files[0]) {
  var reader = new FileReader();
  reader.onload = function(e) {
    function na(){
      $('#logoPreview').attr("src", e.target.result)
      $('#imgPreviewBox').show(300);
    }
    na();
  }
  reader.readAsDataURL(input.files[0]); // convert to base64 string
  }
}


$("#img").change(function() {
readURL(this);
});


</script>

<script>
 
  $('.deleteIntern').click((e)=> {
   var intern =JSON.parse(e.target.previousElementSibling.value);


Swal.fire({
  title: 'Are you sure?',
  text: "You won't be able to revert this!",
  icon: 'warning',
  showCancelButton: true,
  confirmButtonColor: '#3085d6',
  cancelButtonColor: '#d33',
  confirmButtonText: 'Yes, delete it!'
}).then((result)=> {
   if(result.isConfirmed){
  toastr["success"]("Please wait, your request is being processing");
      $.ajax({
        type: 'DELETE',
        url : '/interns',
        data : intern,
        success :  function(res){
          if(res.status){
             Swal.fire(
          'Success',
           res.msg,
          'success'
        ).then(()=> {

            e.target.parentElement.parentElement.remove();

        })
          
          }
        },
        error : function(err){
          Swal.fire(
              'Error',
              'Something went wrong',
              'error'
            )
        }
      })

   }
})



  })
</script>


<%- include("../../partials/admin-footer") -%>