<%- include("../../partials/admin-header") -%>
<%- include("../../partials/admin-nav") -%>


        <div class="content-wrapper p-5">
         
          <div class="row">
            <div class="col-md-12 stretch-card">
              <div class="card">
                <div class="card-body">
                  <p class="card-title">Applications</p>
                      





                       <div class="table-responsive">
                              <table id="recent-purchases-listing" class="table">
                                <thead>
                                  <tr>
                                      <th>Name</th>
                                      <th>Applied For</th>
                                      <th>Github & </br> Portfolio</th>
                                      <th>Resume</th>
                                      <th>Actions</th>
                                  </tr>
                                </thead>
                                <tbody>


                    <% if(applications){ %>
                        <% applications.forEach((application)=> {  %>
                          <tr>
                               
                              <td><h5><%= application.aplicant.name %></h5></td> 
                              <td><%= application.applied_for %></td>
                              <td>
                               <a href="<%= application.aplicant.github_link %>" target="_blank">Github <i class="mdi   mdi-link-variant "></i></a>
                             </br>
                               <a href="<%= application.aplicant.portfolio_link %>" target="_blank">Portfolio <i class="mdi   mdi-link-variant "></i></a>
                              </td>
                              <td><a href="<%= application.aplicant.cv %>" target="_blank">View</a></td>
                              <td class="text-center">
                                <input type="text" value="<%= JSON.stringify(application) %>" class="d-none">
                                
                                <button class="btn btn-danger px-3 py-2 deleteApplication">Delete</button>
                              </td>
                          </tr>   
                       <%  }) %>
                    <% } %> 

                      </tbody>
                    </table>
                  </div>

                </div>
              </div>
            </div>
          </div>
        </div>



<script type="text/javascript">
  
/*Swal.fire({
  title: 'Are you sure?',
  text: "You won't be able to revert this!",
  icon: 'warning',
  showCancelButton: true,
  confirmButtonColor: '#3085d6',
  cancelButtonColor: '#d33',
  confirmButtonText: 'Yes, delete it!'
}).then((result)=> {
  console.log(result)
})

*/


function showToast(){
   toastr["success"]("ripon", "Ripon");
   toastr["error"]("ripon", "Ripon");
   toastr["warning"]("ripon", "Ripon");
   toastr["info"]("ripon", "Ripon");
}


$(".deleteApplication").click((e)=> {
  var application = e.target.previousElementSibling.value;




Swal.fire({
  title: 'Are you sure?',
  text: "You won't be able to revert this!",
  icon: 'warning',
  showCancelButton: true,
  confirmButtonColor: '#3085d6',
  cancelButtonColor: '#d33',
  confirmButtonText: 'Yes, Remove it!'
}).then((result)=> {
   if(result.isConfirmed){
  toastr["success"]("Please wait, your request is being processing");
    $.ajax({
      type : 'DELETE',
      url : '/applications',
      data : JSON.parse(application),
      success : function(res){
        if(res.status){
          Swal.fire(
              'Success',
               res.msg,
              'success'
          ).then(()=> {
            e.target.parentElement.parentElement.remove();
        })
          
        }
      },
      error : function(err){
        Swal.fire(
          'Error',
          'Something went wrong',
          'error'
        )
      }
    })

   }
 })







})


</script>



<%- include("../../partials/admin-footer") -%>